function dy = Acceleration(t,y)
Q1=y(1)
Qp1= y(2)
Q2= y(3)
Qp2 = y(4)
g= 9.8
m1 = 2
l=0.6
m2= 1.5
Tau = [0;0]
c1 = cos(Q1)
c2 = cos(Q2)
c12 = cos(Q1+Q2)
s1 = sin(Q1)
s2 = sin(Q2)
s12 = sin(Q1+Q2)
Ai = [1/3*m1*l.^2+4/3*m2*l.^2+m2*c2*l.^2 1/3*m2*l.^2+1/2*m2*l.^2*c2;1/3*m2*l.^2+1/2*m2*l.^2*c2 1/3*m2*l.^2]
Bi = [-1/2*m2*s2*l.^2*Qp2.^2-m2*s2*l.^2*Qp1*Qp2;1/2*m2*s2*l.^2*Qp1.^2]
Ci = [1/2*m1*g*l*c1+1/2*m2*g*l*c12+m2*g*l*c1;1/2*m2*g*l*c12]
Q = inv(Ai)*(Tau-Bi-Ci)
dy = [y(2);Q(1);y(4);Q(2)]

